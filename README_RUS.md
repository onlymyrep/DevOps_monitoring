# Мониторинг

Использование инструментов мониторинга для отслеживания метрик и критических ситуаций.

## Contents

1. [Chapter I](#chapter-i) 
2. [Chapter II](#chapter-ii) \
   2.1. [Получение метрик и логов](#part-1-получение-метрик-и-логов) \
   2.2. [Визуализация](#part-2-визуализация) \
   2.3. [Отслеживание критических событий](#part-3-отслеживание-критических-событий) 


## Chapter I

Мониторинг приложения - важная часть разработки любого ПО. Мониторинг обычно включает в себя сбор и визуализацию метрик и логов как приложения, так и инфраструктуры, в которой это приложение развернуто. 

Метрики - это числовые значения, отображающие актуальные параметры и эффективность работы приложения. Логи - это текстовые записи с важной информацией о ходе работе приложения.

Фактически связка Prometheus и Grafana является одним из наиболее часто используемых решений задач сбора и визуализации метрик в приложениях и распределенных системах. Loki - это вдохновленный Prometheus инструмент сбора текстовых логов.

## Chapter II

Итогом выполненной работы должен быть отчет с подробными описаниями выполнения каждого из пунктов, подкрепленного скриншотами. Отчет формируется в виде markdown файла в директории `src` с именем `REPORT.MD`

## Part 1. Получение метрик и логов

В этой главе тебе предстоит настроить Prometheus и Loki для сбора метрик и логов приложения.

**== Задание ==**

1) Использовать docker swarm из первого проекта. 

2) Написать при помощи библиотеки Micrometer сборщики следующих метрик приложения: 
   - количество отправленных сообщений в rabbitmq;
   - количество обработанных сообщений в rabbitmq;
   - количество бронирований;
   - количество полученных запросов на gateway;
   - количество полученных запросов на авторизацию пользователей.

3) Добавить логи приложения с помощью Loki.

4) Создать новый стек для docker swarm из сервисов с Prometheus Server, Loki, node_exporter, blackbox_exporter, cAdvisor. Проверить получение метрик на порту 9090 через браузер.

## Part 2. Визуализация

В этой главе тебе предстоит настроить Grafana для визуализации метри и логов.

**== Задание ==**

1) Развернуть grafana как новый сервис в стеке мониторинга.

2) Добавить в grafana дашборд со следуюшими метриками:
   - количество нод;
   - количество контейнеров;
   - количество стеков;
   - использование CPU по сервисам;
   - использование CPU по ядрам и узлам;
   - затраченная RAM;
   - доступная и занятая память;
   - количество CPU;
   - доступность google.com;
   - количество отправленных сообщений в rabbitmq;
   - количество обработанных сообщений в rabbitmq;
   - количество бронирований;
   - количество полученных запросов на gateway;
   - количество полученных запросов на авторизацию пользователей;
   - логи приложения.

## Part 3. Отслеживание критических событий

В этой главе тебе предстоит настроить Alert Manager для оповещения о критических событиях.

**== Задание ==**

1) Развернуть alert manager как новый сервис в стеке монтиторинга.

2) Добавить следующие критические события:
   - доступная память меньше 100 мб;
   - затраченная RAM больше 1гб;
   - использование CPU по сервису превышает 10%.

3) Настроить получение оповещений через личные email и телеграм.
